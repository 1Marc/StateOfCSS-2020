###############################################################################
#
# GENERIC
#
###############################################################################

pageIntroductionTemplate:
    blockType: PageIntroductionBlock

recommendedResourcesTemplate:
    blockName: recommendedResources
    blockType: RecommendedResourcesBlock
    showDescription: false

    #  note: query does not currently work because sponsor values would need to be
    #  wrapped in quotes
    # dataPath: 'resources.edges'
    # query: >
    #     resources: allRecommendedResourcesYaml(filter: {id: {in: [${sponsors}]}}) {
    #         edges {
    #             node {
    #                 name
    #                 url
    #                 image
    #                 id
    #                 description
    #             }
    #         }
    #     }

###############################################################################
#
# DEMOGRAPHICS
#
###############################################################################

# Used for salaries, company size, experience, etc. blocks that only show the current year of data
demographicsTemplate:
    blockType: VerticalBarBlock
    dataPath: 'surveyApi.survey.demographics.${id}.year'
    # titleId: 'user_info.${id}'
    # descriptionId: 'user_info.${id}.description'
    showDescription: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                demographics {
                    ${id} {
                        year(year: ${currentYear}) {
                            year
                            total
                            completion {
                                percentage
                                count
                            }
                            buckets {
                                id
                                count
                                percentage
                            }
                        }
                    }
                }
            }
        }

knowledgeScoreTemplate:
    blockType: VerticalBarBlock
    dataPath: 'surveyApi.survey.demographics.knowledge_score.year'
    # titleId: 'user_info.knowledge_score'
    # descriptionId: 'user_info.knowledge_score.description'
    showDescription: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                demographics {
                    knowledge_score {
                        year(year: ${currentYear}) {
                            year
                            buckets {
                                id
                                count
                                percentage
                            }
                        }
                    }
                }
            }
        }

proficiencyTemplate:
    blockType: VerticalBarBlock
    dataPath: 'surveyApi.survey.${id}.year'
    # titleId: 'user_info.${id}'
    # descriptionId: 'user_info.${id}.description'
    showDescription: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                ${id}: proficiency(id: ${id}) {
                    id
                    year(year: ${currentYear}) {
                        year
                        total
                        completion {
                            count
                            percentage
                        }
                        buckets {
                            id
                            count
                            percentage
                        }
                    }
                }
            }
        }

sourceTemplate:
    blockType: VerticalBarBlock
    dataPath: 'surveyApi.survey.demographics.${id}.year' # select the 4th array item to select the 4th year
    showDescription: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                demographics {
                    ${id} {
                        year(year: ${currentYear}) {
                            year
                            total
                            completion {
                                percentage
                                count
                            }
                            buckets {
                                id
                                count
                                percentage
                                entity {
                                    name
                                    homepage
                                    github {
                                        url
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
###############################################################################
#
# OVERVIEW
#
###############################################################################

scatterplotOverviewTemplate:
    blockType: ToolsScatterplotBlock
    dataPath: 'surveyApi.survey.tools'
    showDescription: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                 tools(ids: [${allTools}]) {
                    id
                    entity {
                        homepage
                        name
                        github {
                            url
                        }
                    }
                    experience {
                        year(year:${currentYear}) {
                            total
                            buckets{
                                id
                                count
                                percentage
                            }
                        }
                    }
                }
            }
        }

toolsArrowsTemplate:
    blockType: ToolsArrowsBlock
    dataPath: 'surveyApi.survey.tools'
    showDescription: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                tools {
                    id
                    entity {
                        name
                        description
                        id
                    }
                    experience {
                        all_years {
                            buckets {
                                percentage
                                id
                            }
                        }
                    }
                }
            }
        }

###############################################################################
#
# FEATURES
#
###############################################################################

featuresOverviewTemplate:
    blockType: FeaturesOverviewBlock
    dataPath: 'surveyApi.survey.features'
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                features(ids: [${allFeatures}]) {
                    id
                    name
                    experience{
                        year(year: ${currentYear}) {
                            year
                            completion {
                                count
                                percentage
                            }
                            buckets {
                                id
                                count
                                percentage
                            }
                        }
                    }
                }
            }
        }

featuresCategoryOverviewTemplate:
    blockType: FeaturesOverviewBlock
    blockName: featuresCategoryOverview
    dataPath: 'surveyApi.survey.features'
    bucketKeysName: featureExperienceSimplified
    showLegend: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                features(ids: [${featureIds}]) {
                    id
                    experience{
                        year(year: ${currentYear}) {
                            year
                            completion {
                                count
                                percentage
                            }
                            buckets {
                                id
                                count
                                percentage
                            }
                        }
                    }
                }
            }
        }

# Used for destructuring, arrow functions, WebGL, etc.
featureExperienceTemplate:
    blockType: FeatureExperienceBlock
    dataPath: 'surveyApi.survey.${id}'
    showDescription: true
    bucketKeysName: features
    showLegend: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                ${id}: feature(id: ${id}) {
                    id
                    name
                    mdn {
                        locale
                        url
                        title
                        summary
                    }
                    experience {
                        year(year: ${currentYear}) {
                            year
                            completion {
                                count
                                percentage
                            }
                            buckets {
                                id
                                count
                                percentage
                            }
                        }
                    }
                }
            }
        }

otherFeaturesTemplate:
    blockType: HorizontalBarBlock
    # titleId: 'features_others.${id}'
    # descriptionId: 'features_others.${id}.description'
    showDescription: true
    mode: relative
    dataPath: 'surveyApi.survey.${id}.year'
    translateData: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                ${id}: features_others(id: ${id}) {
                    id
                    year(year: ${currentYear}) {
                        year
                        total
                        completion {
                            count
                            percentage
                        }
                        buckets{
                            id
                            name
                            count
                            percentage
                        }
                    }
                }
            }
        }

###############################################################################
#
# TOOLS
#
###############################################################################

toolsSectionOverviewTemplate:
    blockType: ToolsSectionOverviewBlock
    dataPath: 'surveyApi.survey.tools'
    bucketKeysName: tools
    showLegend: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                tools(ids: [${toolIds}]) {
                    id
                    entity {
                        name
                    }
                    experience {
                        year(year: 2020) {
                            buckets {
                                id
                                count
                                percentage
                            }
                        }
                    }
                }
            }
        }

toolsSectionStreamsTemplate:
    blockType: ToolsSectionStreamsBlock
    dataPath: 'surveyApi.survey.tools'
    bucketKeysName: tools
    showLegend: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                tools(ids: [${toolIds}]) {
                    id
                    entity {
                        name
                        homepage
                        github {
                            url
                        }
                    }
                    experience {
                        all_years {
                            year
                            total
                            completion {
                                count
                                percentage
                            }
                            buckets {
                                id
                                count
                                percentage
                            }
                        }
                    }
                }
            }
        }

toolHeaderTemplate:
    blockType: ToolHeaderBlock
    dataPath: surveyApi.survey.headerData
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                headerData: tool(id: ${toolId}) {
                    id
                    entity {
                        name
                        description
                        homepage
                        npm
                        github {
                            stars
                            url
                        }
                    }
                }
            }
        }

toolExperienceTemplate:
    blockType: ToolExperienceBlock
    blockName: tool_experience
    dataPath: surveyApi.survey.${id}_experience
    bucketKeysName: tools
    showLegend: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                ${id}_experience: tool(id: ${id}) {
                    id
                    entity {
                        homepage
                        name
                        github {
                            url
                        }
                    }
                    experience {
                        all_years {
                            year
                            total
                            completion {
                                count
                                percentage
                            }
                            awarenessInterestSatisfaction {
                                awareness
                                interest
                                satisfaction
                            }
                            buckets {
                                id
                                count
                                percentage
                            }
                        }
                    }
                }
            }
        }

toolExperienceGraphTemplate:
    blockType: ToolExperienceGraphBlock
    dataPath: surveyApi.survey.tool
    showLegend: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                tool(id: ${toolId}) {
                    id
                    entity {
                        homepage
                        name
                        github {
                            url
                        }
                    }
                    experienceGraph {
                        nodes {
                            id
                            year
                            experience
                        }
                        links {
                            source
                            target
                            count
                        }
                    }
                }
            }
        }

toolsExperienceRankingTemplate:
    blockType: ToolsExperienceRankingBlock
    blockName: tools_experience_ranking
    dataPath: 'surveyApi.survey.tools_rankings.experience'
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                tools_rankings(ids: [${toolsCategories[sectionId]}]) {
                    ids
                    experience {
                        id
                        entity {
                            name
                        }
                        awareness {
                            year
                            rank
                            percentage
                        }
                        interest {
                            year
                            rank
                            percentage
                        }
                        satisfaction {
                            year
                            rank
                            percentage
                        }
                    }
                }
            }
        }

heatmapTemplate:
    blockType: HeatmapBlock
    dataPath: 'surveyApi.survey.matrices.tools.${heatmapId}.year'
    showDescription: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                matrices {
                    tools(ids: [${toolIds}]) {
                        ${heatmapId}(experience: would_use) {
                            year(year: ${currentYear}) {
                                year
                                buckets{
                                    average
                                    total
                                    id
                                    entity{
                                        name
                                    }
                                    ranges {
                                        range
                                        percentage
                                        count
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

scatterplotTemplate:
    blockType: ToolsScatterplotBlock
    dataPath: 'surveyApi.survey.tools'
    showDescription: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                 tools(ids:[${toolIds}]) {
                    id
                    entity {
                        homepage
                        name
                        github {
                                url
                              }
                    }
                    experience {
                        year(year:${currentYear}) {
                            total
                            buckets{
                                id
                                count
                                percentage
                            }
                        }
                    }
                }
            }
        }

###############################################################################
#
# Happiness
#
###############################################################################

happinessTemplate:
    # blockType: HappinessBlock
    blockType: VerticalBarBlock
    dataPath: 'surveyApi.survey.${id}_happiness.year'
    showDescription: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                ${id}_happiness: happiness(id: ${id}) {
                    year(year: ${currentYear}) {
                        year
                        mean
                        buckets {
                            count
                            id
                            percentage
                        }
                    }
                }
            }
        }

###############################################################################
#
# OPINIONS
#
###############################################################################

# Used for "I think JavaScript is moving in the right direction", etc. blocks
# {id} refers to the current subject
opinionTemplate:
    blockType: OpinionBlock
    # titleId: 'opinions.${id}'
    dataPath: 'surveyApi.survey.${id}.all_years'
    showDescription: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                ${id}: opinion(id: ${id}) {
                    id
                    all_years {
                        year
                        total
                        completion {
                            count
                            percentage
                        }
                        buckets {
                            id
                            count
                            percentage
                        }
                    }
                }
            }
        }

opinionsOthersTemplate:
    blockType: HorizontalBarBlock
    dataPath: 'surveyApi.survey.${id}.year'
    # titleId: 'opinions_others.${id}'
    # descriptionId: 'opinions_others.${id}.description'
    showDescription: true
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                ${id}: opinions_others(id: ${id}) {
                    id
                    year(year: ${currentYear}) {
                        year
                        total
                        completion {
                            count
                            percentage
                        }
                        buckets {
                            id
                            count
                            percentage
                        }
                    }
                }
            }
        }

###############################################################################
#
# OTHER TOOLS
#
###############################################################################

otherToolsTemplate:
    blockType: HorizontalBarBlock
    showDescription: true
    mode: absolute
    dataPath: 'surveyApi.survey.${id}.year'
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                ${id}: tools_others(id: ${id}) {
                    id
                    year(year: ${currentYear}) {
                        year
                        total
                        completion {
                            count
                            percentage
                        }
                        buckets{
                            id
                            count
                            percentage
                            entity {
                                id
                                homepage
                                name
                                github {
                                    url
                                }
                            }
                        }
                    }
                }
            }
        }


otherToolsFreeFormTemplate:
    blockType: HorizontalBarBlock
    showDescription: true
    mode: relative
    units: count
    dataPath: 'surveyApi.survey.${id}.year'
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                ${id}: tools_others(id: ${id}) {
                    id
                    year(year: ${currentYear}) {
                        year
                        total
                        completion {
                            count
                            percentage
                        }
                        buckets{
                            id
                            count
                            percentage
                            entity {
                                id
                                homepage
                                name
                                github {
                                    url
                                }
                            }
                        }
                    }
                }
            }
        }

###############################################################################
#
# RESOURCES
#
###############################################################################

resourcesTemplate:
    blockType: HorizontalBarBlock
    showDescription: true
    mode: absolute
    dataPath: 'surveyApi.survey.${id}.year'
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                ${id}: resources(id: ${id}) {
                    id
                    year(year: ${currentYear}) {
                        year
                        total
                        completion {
                            count
                            percentage
                        }
                        buckets {
                            id
                            count
                            percentage
                            entity {
                                homepage
                                name
                                github {
                                    url
                                }
                            }
                        }
                    }
                }
            }
        }


resourcesFreeFormTemplate:
    blockType: HorizontalBarBlock
    showDescription: true
    mode: relative
    units: count
    dataPath: 'surveyApi.survey.${id}.year'
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                ${id}: resources(id: ${id}) {
                    id
                    year(year: ${currentYear}) {
                        year
                        total
                        completion {
                            count
                            percentage
                        }
                        buckets {
                            id
                            count
                            percentage
                            entity {
                                homepage
                                name
                                github {
                                    url
                                }
                            }
                        }
                    }
                }
            }
        }

###############################################################################
#
# ENVIRONMENTS
#
###############################################################################

environmentTemplate:
    blockType: HorizontalBarBlock
    showDescription: true
    mode: relative
    dataPath: 'surveyApi.survey.${id}.year'
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                ${id}: environments(id: ${id}) {
                    id
                    year(year: ${currentYear}) {
                        year
                        total
                        completion {
                            count
                            percentage
                        }
                        buckets {
                            id
                            count
                            percentage
                        }
                    }
                }
            }
        }

environmentRatingTemplate:
    blockType: VerticalBarBlock
    showDescription: true
    showLegend: true
    mode: relative
    i18nNamespace: options
    dataPath: 'surveyApi.survey.${id}.year'
    query: >
        surveyApi {
            survey(survey: ${surveyType}) {
                ${id}: environments_ratings(id: ${id}) {
                    id
                    year(year: ${currentYear}) {
                        year
                        total
                        completion {
                            count
                            percentage
                        }
                        buckets {
                            id
                            count
                            percentage
                        }
                    }
                }
            }
        }
